### 排课（定时触发）

1.首先老师会设置可用时间，比如周一周三周五早上08:00-08:30.

2.根据基础时间段配置表内的时间（早8点到晚10点，30分钟为一个时间段，比如08:00-08:30,08:30-09:00），直播间的数量进行排课

如果直播间数量为5，则08:00-08:30同一个时间段的课程为5节。

3.根据老师设置的可用时间进行排课填充，一个老师同一个时间段只能带上一次课，目前存在连排的情况。

因为直播间数量只有五个，存在老师过剩的情况，目前会按照入职时间优先进行排课。

### 教师可用时间段变更的逻辑（操作触发）

只会优化已排课的日期课程，不会新初始化排课。

老师修改可用时间，如果新增，直接修改可用时间。

如果删除可用时间，会进行是否有预约成功的课程判断。比如老师删除周一早上08:00-08:30的时间段，会去判断是否有周一早上08:00-08:3已预约且并未结束的课程，如果有，则不允许删除该时间段。

教师可用时间的变动，会影响排课的情况，所以会触发排课优化的操作。

**情况一**

比如直播间有5个，周二2018-08-28 08:00-08:30的时间段只有3个老师可以上课，排课的时候只会给这3个老师排课，这样有两个直播间08:00-08:30时间是空闲的，这时候A老师周二新增08:00-08:30可用时间，则会触发优化排课的操作，会将A老师08:00-08:30进行排课，其他之前排好的3个老师不做操作。

**情况二**

比如直播间有5个，周二2018-08-28 08:00-08:30的时间段有10个老师可以上课，排课的时候会按照入职时间先后给5个老师排课，这样是没有剩余直播间的，如果5个老师中的A教师删除08:00-08:30可用时间，则会释放直播间资源，需要重新分配给其他周二08:00-08:30可以上课的老师。

  


![](/assets/schedule-info.png)  


